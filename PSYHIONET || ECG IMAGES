{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4288f7e4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T01:52:19.231444Z",
     "iopub.status.busy": "2026-01-10T01:52:19.231226Z",
     "iopub.status.idle": "2026-01-10T01:52:19.237991Z",
     "shell.execute_reply": "2026-01-10T01:52:19.237289Z"
    },
    "papermill": {
     "duration": 0.011075,
     "end_time": "2026-01-10T01:52:19.239322",
     "exception": false,
     "start_time": "2026-01-10T01:52:19.228247",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PATH OK\n"
     ]
    }
   ],
   "source": [
    "import sys\n",
    "\n",
    "sys.path.append(\n",
    "    \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\"\n",
    ")\n",
    "\n",
    "print(\"PATH OK\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "4d4417eb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T01:52:19.243332Z",
     "iopub.status.busy": "2026-01-10T01:52:19.243125Z",
     "iopub.status.idle": "2026-01-10T01:52:24.083873Z",
     "shell.execute_reply": "2026-01-10T01:52:24.082899Z"
    },
    "papermill": {
     "duration": 4.844739,
     "end_time": "2026-01-10T01:52:24.085678",
     "exception": false,
     "start_time": "2026-01-10T01:52:19.240939",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: timm in /usr/local/lib/python3.12/dist-packages (1.0.20)\r\n",
      "Collecting connected-components-3d\r\n",
      "  Downloading connected_components_3d-3.26.1-cp312-cp312-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (32 kB)\r\n",
      "Requirement already satisfied: einops in /usr/local/lib/python3.12/dist-packages (0.8.1)\r\n",
      "Requirement already satisfied: torch in /usr/local/lib/python3.12/dist-packages (from timm) (2.8.0+cu126)\r\n",
      "Requirement already satisfied: torchvision in /usr/local/lib/python3.12/dist-packages (from timm) (0.23.0+cu126)\r\n",
      "Requirement already satisfied: pyyaml in /usr/local/lib/python3.12/dist-packages (from timm) (6.0.3)\r\n",
      "Requirement already satisfied: huggingface_hub in /usr/local/lib/python3.12/dist-packages (from timm) (0.36.0)\r\n",
      "Requirement already satisfied: safetensors in /usr/local/lib/python3.12/dist-packages (from timm) (0.6.2)\r\n",
      "Requirement already satisfied: numpy in /usr/local/lib/python3.12/dist-packages (from connected-components-3d) (2.0.2)\r\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (3.20.1)\r\n",
      "Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (2025.10.0)\r\n",
      "Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (25.0)\r\n",
      "Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (2.32.5)\r\n",
      "Requirement already satisfied: tqdm>=4.42.1 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (4.67.1)\r\n",
      "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (4.15.0)\r\n",
      "Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (1.2.1rc0)\r\n",
      "Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from torch->timm) (75.2.0)\r\n",
      "Requirement already satisfied: sympy>=1.13.3 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (1.13.3)\r\n",
      "Requirement already satisfied: networkx in /usr/local/lib/python3.12/dist-packages (from torch->timm) (3.5)\r\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (3.1.6)\r\n",
      "Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.77)\r\n",
      "Requirement already satisfied: nvidia-cuda-runtime-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.77)\r\n",
      "Requirement already satisfied: nvidia-cuda-cupti-cu12==12.6.80 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.80)\r\n",
      "Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (9.10.2.21)\r\n",
      "Requirement already satisfied: nvidia-cublas-cu12==12.6.4.1 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.4.1)\r\n",
      "Requirement already satisfied: nvidia-cufft-cu12==11.3.0.4 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (11.3.0.4)\r\n",
      "Requirement already satisfied: nvidia-curand-cu12==10.3.7.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (10.3.7.77)\r\n",
      "Requirement already satisfied: nvidia-cusolver-cu12==11.7.1.2 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (11.7.1.2)\r\n",
      "Requirement already satisfied: nvidia-cusparse-cu12==12.5.4.2 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.5.4.2)\r\n",
      "Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (0.7.1)\r\n",
      "Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (2.27.3)\r\n",
      "Requirement already satisfied: nvidia-nvtx-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.77)\r\n",
      "Requirement already satisfied: nvidia-nvjitlink-cu12==12.6.85 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.85)\r\n",
      "Requirement already satisfied: nvidia-cufile-cu12==1.11.1.6 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (1.11.1.6)\r\n",
      "Requirement already satisfied: triton==3.4.0 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (3.4.0)\r\n",
      "Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.12/dist-packages (from torchvision->timm) (11.3.0)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from sympy>=1.13.3->torch->timm) (1.3.0)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2->torch->timm) (3.0.3)\r\n",
      "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests->huggingface_hub->timm) (3.4.4)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests->huggingface_hub->timm) (3.11)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests->huggingface_hub->timm) (2.6.2)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests->huggingface_hub->timm) (2025.11.12)\r\n",
      "Downloading connected_components_3d-3.26.1-cp312-cp312-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (4.7 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.7/4.7 MB\u001b[0m \u001b[31m49.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: connected-components-3d\r\n",
      "Successfully installed connected-components-3d-3.26.1\r\n"
     ]
    }
   ],
   "source": [
    "!pip install timm connected-components-3d einops"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8c9e5ba1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T01:52:24.091223Z",
     "iopub.status.busy": "2026-01-10T01:52:24.090961Z",
     "iopub.status.idle": "2026-01-10T01:52:38.801760Z",
     "shell.execute_reply": "2026-01-10T01:52:38.800671Z"
    },
    "papermill": {
     "duration": 14.715723,
     "end_time": "2026-01-10T01:52:38.803610",
     "exception": false,
     "start_time": "2026-01-10T01:52:24.087887",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.\n",
      "  warnings.warn(\n",
      "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\n",
      "IMPORTS WORKING ✅\n"
     ]
    }
   ],
   "source": [
    "import stage0_model\n",
    "import stage1_model\n",
    "import stage2_common\n",
    "\n",
    "print(\"IMPORTS WORKING ✅\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ee11f25d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T01:52:38.811038Z",
     "iopub.status.busy": "2026-01-10T01:52:38.810507Z",
     "iopub.status.idle": "2026-01-10T01:53:03.356688Z",
     "shell.execute_reply": "2026-01-10T01:53:03.355884Z"
    },
    "papermill": {
     "duration": 24.552112,
     "end_time": "2026-01-10T01:53:03.358401",
     "exception": false,
     "start_time": "2026-01-10T01:52:38.806289",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "THIS_DIR: /kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\n",
      "REF_PT: (9, 2)\n",
      "<All keys matched successfully>\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9db0ae605e8447f1834ba6ba2798d89d",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\n",
      "<All keys matched successfully>\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "125bc181ec8e43b0ba24a3aadac25777",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "01f9db5e896b4e38a3d6854f635f1a0f",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "1f0aa0fa0331447d8b587feeae128699",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1053922973_0_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1053922973_1_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1053922973_2_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1053922973_3_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1053922973_4_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1053922973_5_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1053922973_6_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1053922973_7_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1053922973_8_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1053922973_9_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1053922973_10_I</td>\n",
       "      <td>-0.033880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1053922973_11_I</td>\n",
       "      <td>-0.033957</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1053922973_12_I</td>\n",
       "      <td>-0.033998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1053922973_13_I</td>\n",
       "      <td>-0.033689</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1053922973_14_I</td>\n",
       "      <td>-0.032574</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1053922973_15_I</td>\n",
       "      <td>-0.031376</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1053922973_16_I</td>\n",
       "      <td>-0.030799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1053922973_17_I</td>\n",
       "      <td>-0.031270</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1053922973_18_I</td>\n",
       "      <td>-0.032442</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1053922973_19_I</td>\n",
       "      <td>-0.033609</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1053922973_20_I</td>\n",
       "      <td>-0.033990</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1053922973_21_I</td>\n",
       "      <td>-0.034022</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1053922973_22_I</td>\n",
       "      <td>-0.034013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1053922973_23_I</td>\n",
       "      <td>-0.033792</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1053922973_24_I</td>\n",
       "      <td>-0.032840</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1053922973_25_I</td>\n",
       "      <td>-0.031642</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1053922973_26_I</td>\n",
       "      <td>-0.030902</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1053922973_27_I</td>\n",
       "      <td>-0.031181</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1053922973_28_I</td>\n",
       "      <td>-0.032265</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1053922973_29_I</td>\n",
       "      <td>-0.033236</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id     value\n",
       "0    1053922973_0_I -0.033880\n",
       "1    1053922973_1_I -0.033880\n",
       "2    1053922973_2_I -0.033880\n",
       "3    1053922973_3_I -0.033880\n",
       "4    1053922973_4_I -0.033880\n",
       "5    1053922973_5_I -0.033880\n",
       "6    1053922973_6_I -0.033880\n",
       "7    1053922973_7_I -0.033880\n",
       "8    1053922973_8_I -0.033880\n",
       "9    1053922973_9_I -0.033880\n",
       "10  1053922973_10_I -0.033880\n",
       "11  1053922973_11_I -0.033957\n",
       "12  1053922973_12_I -0.033998\n",
       "13  1053922973_13_I -0.033689\n",
       "14  1053922973_14_I -0.032574\n",
       "15  1053922973_15_I -0.031376\n",
       "16  1053922973_16_I -0.030799\n",
       "17  1053922973_17_I -0.031270\n",
       "18  1053922973_18_I -0.032442\n",
       "19  1053922973_19_I -0.033609\n",
       "20  1053922973_20_I -0.033990\n",
       "21  1053922973_21_I -0.034022\n",
       "22  1053922973_22_I -0.034013\n",
       "23  1053922973_23_I -0.033792\n",
       "24  1053922973_24_I -0.032840\n",
       "25  1053922973_25_I -0.031642\n",
       "26  1053922973_26_I -0.030902\n",
       "27  1053922973_27_I -0.031181\n",
       "28  1053922973_28_I -0.032265\n",
       "29  1053922973_29_I -0.033236"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import os\n",
    "import gc\n",
    "import cv2\n",
    "import torch\n",
    "import random\n",
    "import traceback\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "from tqdm import tqdm\n",
    "from pathlib import Path\n",
    "from tqdm.auto import tqdm\n",
    "from shutil import copyfile\n",
    "from scipy.signal import resample\n",
    "\n",
    "SEED = 42\n",
    "\n",
    "os.environ[\"PYTHONHASHSEED\"] = str(SEED)\n",
    "os.environ[\"CUBLAS_WORKSPACE_CONFIG\"] = \":4096:8\"\n",
    "\n",
    "random.seed(SEED)\n",
    "np.random.seed(SEED)\n",
    "\n",
    "torch.manual_seed(SEED)\n",
    "torch.cuda.manual_seed(SEED)\n",
    "torch.cuda.manual_seed_all(SEED)\n",
    "\n",
    "torch.backends.cudnn.deterministic = True\n",
    "torch.backends.cudnn.benchmark = False\n",
    "torch.use_deterministic_algorithms(True, warn_only=True)\n",
    "\n",
    "# save seed for reproducibility\n",
    "with open(\"/kaggle/working/seed.txt\", \"w\") as f:\n",
    "    f.write(str(SEED))\n",
    "\n",
    "\n",
    "from stage0_model import Net as Stage0Net\n",
    "from stage0_common import *\n",
    "\n",
    "test_dir = Path(\"/kaggle/input/physionet-ecg-image-digitization/test\")\n",
    "\n",
    "test = pd.read_csv(\"/kaggle/input/physionet-ecg-image-digitization/test.csv\")\n",
    "test['id'] = test['id'].astype(str) \n",
    "test_id = test['id'].unique().tolist()\n",
    "\n",
    "\n",
    "global_dict = {\n",
    "    \"stage0_dir\": \"/kaggle/working/stage0\",\n",
    "    \"stage1_dir\": \"/kaggle/working/stage1\",\n",
    "    \"stage2_dir\": \"/kaggle/working/stage2\",\n",
    "}\n",
    "\n",
    "def change_color(image_rgb):\n",
    "    hsv = cv2.cvtColor(image_rgb, cv2.COLOR_RGB2HSV)\n",
    "    h, s, v = cv2.split(hsv)\n",
    "    \n",
    "    v_denoised = cv2.fastNlMeansDenoising(v, h=6)\n",
    "    \n",
    "    std = np.std(v_denoised)\n",
    "    clip_limit = max(1.0, min(3.5, 2.0 + std / 25))\n",
    "    clahe = cv2.createCLAHE(clipLimit=clip_limit, tileGridSize=(8, 8))\n",
    "    v_enhanced = clahe.apply(v_denoised)\n",
    "    \n",
    "    hsv_enhanced = cv2.merge([h, s, v_enhanced])\n",
    "    return cv2.cvtColor(hsv_enhanced, cv2.COLOR_HSV2RGB)\n",
    "\n",
    "def dw(series_dict, alpha=0.33):\n",
    "    if all(k in series_dict for k in ['I', 'II', 'III']):\n",
    "        L1 = series_dict['I']\n",
    "        L2 = series_dict['II']\n",
    "        L3 = series_dict['III']\n",
    "\n",
    "        error = L2 - (L1 + L3)\n",
    "\n",
    "        series_dict['I'] = L1 + (alpha * error)\n",
    "        series_dict['III'] = L3 + (alpha * error)\n",
    "        series_dict['II'] = L2 - (alpha * error)\n",
    "    \n",
    "    return series_dict\n",
    "\n",
    "def series_to_dict_local(series_4row):\n",
    "    d = {}\n",
    "    names = [['I', 'aVR', 'V1', 'V4'], \n",
    "             ['II', 'aVL', 'V2', 'V5'], \n",
    "             ['III', 'aVF', 'V3', 'V6']]\n",
    "    \n",
    "    for i in range(3):\n",
    "        splits = np.array_split(series_4row[i], 4)\n",
    "        for name, data in zip(names[i], splits):\n",
    "            d[name] = data\n",
    "    \n",
    "    d['II_Long'] = series_4row[3]\n",
    "    return d\n",
    "\n",
    "def dict_to_series_local(d, original_shape):\n",
    "    new_series = np.zeros(original_shape)\n",
    "    new_series[0] = np.concatenate([d['I'], d['aVR'], d['V1'], d['V4']])\n",
    "    new_series[1] = np.concatenate([d['II'], d['aVL'], d['V2'], d['V5']])\n",
    "    new_series[2] = np.concatenate([d['III'], d['aVF'], d['V3'], d['V6']])\n",
    "    new_series[3] = d['II_Long']\n",
    "    \n",
    "    return new_series\n",
    "\n",
    "stage0_dir = Path(global_dict[\"stage0_dir\"])\n",
    "stage0_dir.mkdir(exist_ok=True)\n",
    "\n",
    "stage0_net = Stage0Net(pretrained=False)\n",
    "stage0_net = load_net(stage0_net, '/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/weight/stage0-last.checkpoint.pth')\n",
    "stage0_net.to(\"cuda:0\")\n",
    "stage0_net.eval()\n",
    "\n",
    "for n, sample_id in enumerate(tqdm(test_id)):\n",
    "    path = test_dir / f'{sample_id}.png'\n",
    "    output_path = stage0_dir / f'{sample_id}.png'\n",
    "    \n",
    "    image_original = cv2.imread(str(path), cv2.IMREAD_COLOR)\n",
    "    image_original = cv2.cvtColor(image_original, cv2.COLOR_BGR2RGB)\n",
    "    image_for_model = change_color(image_original)\n",
    "    \n",
    "    batch = image_to_batch(image_for_model)\n",
    "\n",
    "    try:\n",
    "        with torch.no_grad(), torch.amp.autocast('cuda', dtype=torch.float32):\n",
    "            output = stage0_net(batch)\n",
    "        \n",
    "        rotated, keypoint = output_to_predict(image_original, batch, output)\n",
    "        normalised, _, _ = normalise_by_homography(rotated, keypoint)\n",
    "        \n",
    "        cv2.imwrite(str(output_path), cv2.cvtColor(normalised, cv2.COLOR_RGB2BGR))\n",
    "    except Exception as e:\n",
    "        traceback.print_exc()\n",
    "        copyfile(path, output_path)\n",
    "\n",
    "\n",
    "from stage1_model import Net as Stage1Net\n",
    "from stage1_common import *\n",
    "\n",
    "stage0_dir = Path(global_dict[\"stage0_dir\"])\n",
    "stage1_dir = Path(global_dict[\"stage1_dir\"])\n",
    "stage1_dir.mkdir(exist_ok=True)\n",
    "\n",
    "stage1_net = Stage1Net(pretrained=False)\n",
    "stage1_net = load_net(stage1_net, '/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/weight/stage1-last.checkpoint.pth')\n",
    "stage1_net.to(\"cuda:0\")\n",
    "\n",
    "for n, sample_id in enumerate(tqdm(test_id)):\n",
    "    path = stage0_dir / f'{sample_id}.png'\n",
    "    output_path = stage1_dir / f'{sample_id}.png'\n",
    "    image = cv2.imread(path, cv2.IMREAD_COLOR_RGB)\n",
    "    batch = {'image': torch.from_numpy(np.ascontiguousarray(image.transpose(2, 0, 1))).unsqueeze(0)}\n",
    "\n",
    "    try:\n",
    "        with torch.no_grad(), torch.amp.autocast('cuda', dtype=torch.float32):\n",
    "            output = stage1_net(batch)\n",
    "        gridpoint_xy, _ = output_to_predict(image, batch, output)\n",
    "        rectified = rectify_image(image, gridpoint_xy)\n",
    "        cv2.imwrite(output_path, cv2.cvtColor(rectified, cv2.COLOR_RGB2BGR))\n",
    "    except:\n",
    "        traceback.print_exc()\n",
    "        copyfile(path, output_path)\n",
    "\n",
    "import torchvision.transforms as T\n",
    "from stage2_model import *\n",
    "from stage2_common import *\n",
    "from scipy.signal import savgol_filter, medfilt\n",
    "\n",
    "\n",
    "class Net3(nn.Module):\n",
    "    \n",
    "    def __init__(self, pretrained=True):\n",
    "        super(Net3, self).__init__()\n",
    "        encoder_dim = [64, 128, 256, 512]\n",
    "        decoder_dim = [128, 64, 32, 16]\n",
    "\n",
    "        self.encoder = timm.create_model(\n",
    "            model_name='resnet34.a3_in1k', pretrained=pretrained, in_chans=3, num_classes=0, global_pool=''\n",
    "        )\n",
    "\n",
    "        self.decoder = MyCoordUnetDecoder(\n",
    "            in_channel=encoder_dim[-1],\n",
    "            skip_channel=encoder_dim[:-1][::-1] + [0],\n",
    "            out_channel=decoder_dim,\n",
    "            scale=[2, 2, 2, 2]\n",
    "        )\n",
    "        self.pixel = nn.Conv2d(decoder_dim[-1], 4, 1)\n",
    "\n",
    "    def forward(self, image):\n",
    "        encode = encode_with_resnet(self.encoder, image)\n",
    "        last, _ = self.decoder(feature=encode[-1], skip=encode[:-1][::-1] + [None])\n",
    "        pixel = self.pixel(last)\n",
    "        return pixel\n",
    "\n",
    "stage1_dir = Path(global_dict[\"stage1_dir\"])\n",
    "stage2_dir = Path(global_dict[\"stage2_dir\"])\n",
    "stage2_dir.mkdir(exist_ok=True)\n",
    "\n",
    "stage2_net = Net3(pretrained=False).to(\"cuda:0\")\n",
    "model_path = \"/kaggle/input/physio-seg-public/pytorch/net3_009_4200/1/iter_0004200.pt\"\n",
    "stage2_net.load_state_dict(torch.load(model_path))\n",
    "stage2_net.eval()\n",
    "\n",
    "x0, x1 = 0, 2176\n",
    "y0, y1 = 0, 1696\n",
    "zero_mv = [703.5, 987.5, 1271.5, 1531.5]\n",
    "mv_to_pixel = 78.66\n",
    "t0, t1 = 235, 4161\n",
    "\n",
    "resize = T.Resize((1696, 4352), interpolation=T.InterpolationMode.BILINEAR)\n",
    "\n",
    "for n, sample_id in enumerate(tqdm(test_id)):\n",
    "    path = stage1_dir / f'{sample_id}.png'\n",
    "    output_path = stage2_dir / f'{sample_id}.npy'\n",
    "    image = cv2.imread(path, cv2.IMREAD_COLOR_RGB)\n",
    "    \n",
    "    length = test[(test['id']==sample_id) & (test['lead']=='II')].iloc[0].number_of_rows\n",
    "    \n",
    "    image = image[y0:y1, x0:x1] / 255\n",
    "    batch = resize(torch.from_numpy(np.ascontiguousarray(image.transpose(2, 0, 1))).unsqueeze(0)).float().to(\"cuda:0\")\n",
    "    \n",
    "    try:\n",
    "        with torch.no_grad(), torch.amp.autocast('cuda', dtype=torch.float32):\n",
    "            output = stage2_net(batch)\n",
    "        \n",
    "        pixel = torch.sigmoid(output).float().data.cpu().numpy()[0]\n",
    "        series_in_pixel = pixel_to_series(pixel[..., t0:t1], zero_mv, length)\n",
    "        series = (np.array(zero_mv).reshape(4, 1) - series_in_pixel) / mv_to_pixel\n",
    "        \n",
    "        for i in range(series.shape[0]):\n",
    "            series[i] = savgol_filter(series[i], window_length=7, polyorder=2)\n",
    "        \n",
    "        s_dict = series_to_dict_local(series)\n",
    "        s_dict = dw(s_dict)\n",
    "        series = dict_to_series_local(s_dict, series.shape)\n",
    "\n",
    "        np.save(output_path, series)\n",
    "    except:\n",
    "        traceback.print_exc()\n",
    "        series = np.zeros((4, length)) \n",
    "        np.save(output_path, series)\n",
    "\n",
    "def series_dict(series):\n",
    "    d = {}\n",
    "    for l in range(3):\n",
    "        lead_names = [\n",
    "            ['I',   'aVR', 'V1', 'V4'],\n",
    "            ['II',  'aVL', 'V2', 'V5'],\n",
    "            ['III', 'aVF', 'V3', 'V6'],\n",
    "        ][l]\n",
    "        split = np.array_split(series[l], 4)\n",
    "        for (k, s) in zip(lead_names, split):\n",
    "            d[k] = s\n",
    "    \n",
    "    d['II'] = series[3]\n",
    "    \n",
    "    return d\n",
    "\n",
    "\n",
    "stage2_dir = Path(global_dict[\"stage2_dir\"])\n",
    "\n",
    "res = []\n",
    "gb = test.groupby('id')\n",
    "\n",
    "for i, (sample_id, df) in enumerate(tqdm(gb)):\n",
    "    series = np.load(stage2_dir / f'{sample_id}.npy')\n",
    "    d_series = series_dict(series)\n",
    "\n",
    "    for _, d in df.iterrows():\n",
    "        s = d_series.get(d.lead, np.zeros(d.number_of_rows))\n",
    "        \n",
    "        if len(s) != d.number_of_rows:\n",
    "            x_old = np.linspace(0, 1, len(s))\n",
    "            x_new = np.linspace(0, 1, d.number_of_rows)\n",
    "            s = np.interp(x_new, x_old, s)\n",
    "        \n",
    "        row_id = [f'{sample_id}_{x}_{d.lead}' for x in range(d.number_of_rows)]\n",
    "        res.append(pd.DataFrame({'id': row_id, 'value': s}))\n",
    "\n",
    "    if i % 100 == 0:\n",
    "        gc.collect()\n",
    "\n",
    "submission = pd.concat(res, axis=0, ignore_index=True)\n",
    "submission.to_csv('submission.csv', index=False)\n",
    "submission.head(30)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d483cbc",
   "metadata": {
    "papermill": {
     "duration": 0.00311,
     "end_time": "2026-01-10T01:53:03.364986",
     "exception": false,
     "start_time": "2026-01-10T01:53:03.361876",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "databundleVersionId": 14096757,
     "isSourceIdPinned": false,
     "sourceId": 97984,
     "sourceType": "competition"
    },
    {
     "datasetId": 8747012,
     "sourceId": 13746387,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 8620533,
     "sourceId": 13816899,
     "sourceType": "datasetVersion"
    },
    {
     "sourceId": 271051632,
     "sourceType": "kernelVersion"
    },
    {
     "isSourceIdPinned": true,
     "modelId": 528480,
     "modelInstanceId": 513841,
     "sourceId": 677607,
     "sourceType": "modelInstanceVersion"
    }
   ],
   "dockerImageVersionId": 31236,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 49.050925,
   "end_time": "2026-01-10T01:53:05.809367",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2026-01-10T01:52:16.758442",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "01f9db5e896b4e38a3d6854f635f1a0f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_6e78e6ce28a04f3b84702f5ab41104ea",
        "IPY_MODEL_233d2602e74a42688bfa62e4a1449840",
        "IPY_MODEL_616a090461a641a9864f8ef5436645d6"
       ],
       "layout": "IPY_MODEL_1e4c5a11a7224e14996b09d17d623faf",
       "tabbable": null,
       "tooltip": null
      }
     },
     "0760bfd2c68f4d8eabd9f33de20c02bc": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_c031c1afbcfb4ee38bfc9bcc169628aa",
       "placeholder": "​",
       "style": "IPY_MODEL_5df16b06598d48ce9020a6301af22cfb",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:07&lt;00:00,  3.77s/it]"
      }
     },
     "0e7f5865f039406d89991f549c581d4f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "1125a78ead2841e58376e729361cf441": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_5556d9850b3e4f5ba4ca74d22a3ed4aa",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_fbc4c6d84e22490e9b9a8336157b79ec",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "125bc181ec8e43b0ba24a3aadac25777": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_dab7881aa53d48e2a782d5fce1cca315",
        "IPY_MODEL_1125a78ead2841e58376e729361cf441",
        "IPY_MODEL_dd315291386a4e52a555f81c9849e1f0"
       ],
       "layout": "IPY_MODEL_b2b14a87e8c8495b8383ef57f9b13d07",
       "tabbable": null,
       "tooltip": null
      }
     },
     "1946958a70a249aaa155665c168223ff": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "1ae10791fd7341aeb3cb3b7a4852dd9f": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "1e4c5a11a7224e14996b09d17d623faf": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "1f0aa0fa0331447d8b587feeae128699": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_3f994d7a7efb4e94995d2ad8c1669a5c",
        "IPY_MODEL_c978a4c171f047798bc82706f2e79875",
        "IPY_MODEL_c982b98165624ad6bcd95d99161ca87b"
       ],
       "layout": "IPY_MODEL_4f4c7f23031940d1a251c37450a25ac0",
       "tabbable": null,
       "tooltip": null
      }
     },
     "233d2602e74a42688bfa62e4a1449840": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_b6e642f4b095416b99cb66000a6419f5",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_1946958a70a249aaa155665c168223ff",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "33c1fe4210224506a7c207968319c829": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "34bcb2ee0b6f4b0fa56b4a042dcb5a31": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "3f994d7a7efb4e94995d2ad8c1669a5c": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_976de5fbc67d451aa649573c41eb34e5",
       "placeholder": "​",
       "style": "IPY_MODEL_ee66b81a75c64c0cba10337f3e964ed8",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "40ac324afb754fa4b58464c195aff944": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "4f4c7f23031940d1a251c37450a25ac0": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "5556d9850b3e4f5ba4ca74d22a3ed4aa": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "5df16b06598d48ce9020a6301af22cfb": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "5e553447f8964533bbeebfbf0a0c08cb": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "5ed7392020bd4a699f7f1b5b424dbb95": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "5f4ab1fbe188429daa44538479eb276a": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "616a090461a641a9864f8ef5436645d6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_5f4ab1fbe188429daa44538479eb276a",
       "placeholder": "​",
       "style": "IPY_MODEL_fe79cbd247214f38856e24f2507bc161",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:03&lt;00:00,  1.97s/it]"
      }
     },
     "6b5144c9c3c747049dc16a3577205432": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "6e78e6ce28a04f3b84702f5ab41104ea": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_1ae10791fd7341aeb3cb3b7a4852dd9f",
       "placeholder": "​",
       "style": "IPY_MODEL_40ac324afb754fa4b58464c195aff944",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "6fe1a07c9703486bb01136ea6e82da20": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "7151294b74de4a01aa5b016a83b8e20e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "8f56c0ce9dc14a9781d9320e787adddd": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_5e553447f8964533bbeebfbf0a0c08cb",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_7151294b74de4a01aa5b016a83b8e20e",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "976de5fbc67d451aa649573c41eb34e5": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "9db0ae605e8447f1834ba6ba2798d89d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_a0885aee771c427eb355ed55132109d3",
        "IPY_MODEL_8f56c0ce9dc14a9781d9320e787adddd",
        "IPY_MODEL_0760bfd2c68f4d8eabd9f33de20c02bc"
       ],
       "layout": "IPY_MODEL_b768174936ff46c198c2761797025e7c",
       "tabbable": null,
       "tooltip": null
      }
     },
     "a0885aee771c427eb355ed55132109d3": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_5ed7392020bd4a699f7f1b5b424dbb95",
       "placeholder": "​",
       "style": "IPY_MODEL_6fe1a07c9703486bb01136ea6e82da20",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "a33ac6c8c9d241769444ca0c5bf6528c": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "a3acbd48f43a41ac9244f901ac702bcf": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "b2b14a87e8c8495b8383ef57f9b13d07": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "b6e642f4b095416b99cb66000a6419f5": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "b768174936ff46c198c2761797025e7c": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "c031c1afbcfb4ee38bfc9bcc169628aa": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "c55c8d39ebca4b80a156c992102c37c6": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "c978a4c171f047798bc82706f2e79875": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_c55c8d39ebca4b80a156c992102c37c6",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_6b5144c9c3c747049dc16a3577205432",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "c982b98165624ad6bcd95d99161ca87b": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_34bcb2ee0b6f4b0fa56b4a042dcb5a31",
       "placeholder": "​",
       "style": "IPY_MODEL_33c1fe4210224506a7c207968319c829",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:00&lt;00:00,  4.50it/s]"
      }
     },
     "dab7881aa53d48e2a782d5fce1cca315": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_a33ac6c8c9d241769444ca0c5bf6528c",
       "placeholder": "​",
       "style": "IPY_MODEL_a3acbd48f43a41ac9244f901ac702bcf",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "dd315291386a4e52a555f81c9849e1f0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_e6a4cb8afc894725a8161ab6289d485c",
       "placeholder": "​",
       "style": "IPY_MODEL_0e7f5865f039406d89991f549c581d4f",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:04&lt;00:00,  2.22s/it]"
      }
     },
     "e6a4cb8afc894725a8161ab6289d485c": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "ee66b81a75c64c0cba10337f3e964ed8": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "fbc4c6d84e22490e9b9a8336157b79ec": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "fe79cbd247214f38856e24f2507bc161": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
