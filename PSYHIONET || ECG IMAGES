{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "da089723",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T04:42:55.754418Z",
     "iopub.status.busy": "2026-01-10T04:42:55.753803Z",
     "iopub.status.idle": "2026-01-10T04:42:55.761240Z",
     "shell.execute_reply": "2026-01-10T04:42:55.760548Z"
    },
    "papermill": {
     "duration": 0.012091,
     "end_time": "2026-01-10T04:42:55.762521",
     "exception": false,
     "start_time": "2026-01-10T04:42:55.750430",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "⚠️ cc3d patched (offline mode)\n"
     ]
    }
   ],
   "source": [
    "# ===== TEMP cc3d PATCH =====\n",
    "import sys\n",
    "import types\n",
    "\n",
    "cc3d = types.SimpleNamespace()\n",
    "\n",
    "def dummy_cc3d(*args, **kwargs):\n",
    "    raise RuntimeError(\"cc3d not available (internet off)\")\n",
    "\n",
    "cc3d.connected_components = dummy_cc3d\n",
    "sys.modules[\"cc3d\"] = cc3d\n",
    "\n",
    "print(\"⚠️ cc3d patched (offline mode)\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1df40f29",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T04:42:55.766782Z",
     "iopub.status.busy": "2026-01-10T04:42:55.766394Z",
     "iopub.status.idle": "2026-01-10T04:42:55.770250Z",
     "shell.execute_reply": "2026-01-10T04:42:55.769569Z"
    },
    "papermill": {
     "duration": 0.007381,
     "end_time": "2026-01-10T04:42:55.771609",
     "exception": false,
     "start_time": "2026-01-10T04:42:55.764228",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PATH OK\n"
     ]
    }
   ],
   "source": [
    "import sys\n",
    "\n",
    "sys.path.append(\n",
    "    \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\"\n",
    ")\n",
    "\n",
    "print(\"PATH OK\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "31f7dd85",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T04:42:55.775805Z",
     "iopub.status.busy": "2026-01-10T04:42:55.775446Z",
     "iopub.status.idle": "2026-01-10T04:43:18.206157Z",
     "shell.execute_reply": "2026-01-10T04:43:18.205476Z"
    },
    "papermill": {
     "duration": 22.434538,
     "end_time": "2026-01-10T04:43:18.207715",
     "exception": false,
     "start_time": "2026-01-10T04:42:55.773177",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Found existing installation: tensorflow 2.19.0\r\n",
      "Uninstalling tensorflow-2.19.0:\r\n",
      "  Successfully uninstalled tensorflow-2.19.0\r\n",
      "\u001b[2mUsing Python 3.12.12 environment at: /usr\u001b[0m\r\n",
      "\u001b[2K  \u001b[31m×\u001b[0m No solution found when resolving dependencies:\r\n",
      "\u001b[31m  ╰─▶ \u001b[0mBecause only connected-components-3d==3.26.1 is available and\r\n",
      "\u001b[31m      \u001b[0mconnected-components-3d==3.26.1 has no wheels with a matching\r\n",
      "\u001b[31m      \u001b[0mPython ABI tag (e.g., `\u001b[36mcp312\u001b[39m`), we can conclude that all versions of\r\n",
      "\u001b[31m      \u001b[0mconnected-components-3d cannot be used.\r\n",
      "\u001b[31m      \u001b[0mAnd because you require connected-components-3d, we can conclude that\r\n",
      "\u001b[31m      \u001b[0myour requirements are unsatisfiable.\r\n",
      "\r\n",
      "\u001b[31m      \u001b[0m\u001b[36m\u001b[1mhint\u001b[0m\u001b[39m\u001b[1m:\u001b[0m You require \u001b[36mCPython 3.12\u001b[39m (`\u001b[36mcp312\u001b[39m`), but we only found wheels for\r\n",
      "\u001b[31m      \u001b[0m`\u001b[36mconnected-components-3d\u001b[39m` (\u001b[36mv3.26.1\u001b[39m) with the following Python ABI tag:\r\n",
      "\u001b[31m      \u001b[0m`\u001b[36mcp311\u001b[39m`\r\n"
     ]
    }
   ],
   "source": [
    "!pip uninstall -y tensorflow\n",
    "!uv pip install --no-deps --system --no-index --find-links='/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/setup' 'connected-components-3d'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "82823ede",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-10T04:43:18.213131Z",
     "iopub.status.busy": "2026-01-10T04:43:18.212898Z",
     "iopub.status.idle": "2026-01-10T04:43:49.082741Z",
     "shell.execute_reply": "2026-01-10T04:43:49.081943Z"
    },
    "papermill": {
     "duration": 30.874542,
     "end_time": "2026-01-10T04:43:49.084259",
     "exception": false,
     "start_time": "2026-01-10T04:43:18.209717",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.\n",
      "  warnings.warn(\n",
      "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "THIS_DIR: /kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\n",
      "REF_PT: (9, 2)\n",
      "<All keys matched successfully>\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "1c6e800aea7444b98ce8d7800d1b4a72",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Traceback (most recent call last):\n",
      "  File \"/tmp/ipykernel_23/3681099793.py\", line 126, in <cell line: 0>\n",
      "    rotated, keypoint = output_to_predict(image_original, batch, output)\n",
      "                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage0_common.py\", line 277, in output_to_predict\n",
      "    keypoint, k = marker_to_keypoint(image, orientation, marker, scale)\n",
      "                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage0_common.py\", line 224, in marker_to_keypoint\n",
      "    cc = cc3d.connected_components(thresh == label)\n",
      "         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/tmp/ipykernel_23/2361936099.py\", line 8, in dummy_cc3d\n",
      "    raise RuntimeError(\"cc3d not available (internet off)\")\n",
      "RuntimeError: cc3d not available (internet off)\n",
      "Traceback (most recent call last):\n",
      "  File \"/tmp/ipykernel_23/3681099793.py\", line 126, in <cell line: 0>\n",
      "    rotated, keypoint = output_to_predict(image_original, batch, output)\n",
      "                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage0_common.py\", line 277, in output_to_predict\n",
      "    keypoint, k = marker_to_keypoint(image, orientation, marker, scale)\n",
      "                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage0_common.py\", line 224, in marker_to_keypoint\n",
      "    cc = cc3d.connected_components(thresh == label)\n",
      "         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/tmp/ipykernel_23/2361936099.py\", line 8, in dummy_cc3d\n",
      "    raise RuntimeError(\"cc3d not available (internet off)\")\n",
      "RuntimeError: cc3d not available (internet off)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\n",
      "<All keys matched successfully>\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "bbcbf1d7a5124a7891642ebc71d16808",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Traceback (most recent call last):\n",
      "  File \"/tmp/ipykernel_23/3681099793.py\", line 154, in <cell line: 0>\n",
      "    output = stage1_net(batch)\n",
      "             ^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n",
      "    return self._call_impl(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n",
      "    return forward_call(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage1_model.py\", line 186, in forward\n",
      "    last, decode = self.decoder(\n",
      "                   ^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n",
      "    return self._call_impl(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n",
      "    return forward_call(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage1_model.py\", line 77, in forward\n",
      "    d = block(d, s)\n",
      "        ^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n",
      "    return self._call_impl(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n",
      "    return forward_call(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage1_model.py\", line 41, in forward\n",
      "    x = torch.cat([x, skip], dim=1)\n",
      "        ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 214 but got size 213 for tensor number 1 in the list.\n",
      "Traceback (most recent call last):\n",
      "  File \"/tmp/ipykernel_23/3681099793.py\", line 154, in <cell line: 0>\n",
      "    output = stage1_net(batch)\n",
      "             ^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n",
      "    return self._call_impl(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n",
      "    return forward_call(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage1_model.py\", line 186, in forward\n",
      "    last, decode = self.decoder(\n",
      "                   ^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n",
      "    return self._call_impl(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n",
      "    return forward_call(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage1_model.py\", line 77, in forward\n",
      "    d = block(d, s)\n",
      "        ^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n",
      "    return self._call_impl(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n",
      "    return forward_call(*args, **kwargs)\n",
      "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "  File \"/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/stage1_model.py\", line 41, in forward\n",
      "    x = torch.cat([x, skip], dim=1)\n",
      "        ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 214 but got size 213 for tensor number 1 in the list.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet\n"
     ]
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "089aa1a5f52d4c408c98702475c078f5",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "78dc7a27368b47c28d23a3a7a01d1d23",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1053922973_0_I</td>\n",
       "      <td>2.592735</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1053922973_1_I</td>\n",
       "      <td>1.663935</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1053922973_2_I</td>\n",
       "      <td>0.913262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1053922973_3_I</td>\n",
       "      <td>0.340715</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1053922973_4_I</td>\n",
       "      <td>-0.170225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1053922973_5_I</td>\n",
       "      <td>-0.307847</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1053922973_6_I</td>\n",
       "      <td>-0.258107</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1053922973_7_I</td>\n",
       "      <td>-0.228295</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1053922973_8_I</td>\n",
       "      <td>-0.226454</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1053922973_9_I</td>\n",
       "      <td>-0.144052</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1053922973_10_I</td>\n",
       "      <td>-0.200585</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1053922973_11_I</td>\n",
       "      <td>-0.571014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1053922973_12_I</td>\n",
       "      <td>-1.232349</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1053922973_13_I</td>\n",
       "      <td>-1.956533</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1053922973_14_I</td>\n",
       "      <td>-2.600490</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1053922973_15_I</td>\n",
       "      <td>-2.744738</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1053922973_16_I</td>\n",
       "      <td>-2.388441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1053922973_17_I</td>\n",
       "      <td>-1.694855</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1053922973_18_I</td>\n",
       "      <td>-0.963314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1053922973_19_I</td>\n",
       "      <td>-0.377474</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1053922973_20_I</td>\n",
       "      <td>-0.165994</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1053922973_21_I</td>\n",
       "      <td>-0.175707</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1053922973_22_I</td>\n",
       "      <td>-0.230672</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1053922973_23_I</td>\n",
       "      <td>-0.230821</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1053922973_24_I</td>\n",
       "      <td>-0.230940</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1053922973_25_I</td>\n",
       "      <td>-0.230875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1053922973_26_I</td>\n",
       "      <td>-0.229927</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1053922973_27_I</td>\n",
       "      <td>-0.227752</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1053922973_28_I</td>\n",
       "      <td>-0.225159</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1053922973_29_I</td>\n",
       "      <td>-0.163965</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id     value\n",
       "0    1053922973_0_I  2.592735\n",
       "1    1053922973_1_I  1.663935\n",
       "2    1053922973_2_I  0.913262\n",
       "3    1053922973_3_I  0.340715\n",
       "4    1053922973_4_I -0.170225\n",
       "5    1053922973_5_I -0.307847\n",
       "6    1053922973_6_I -0.258107\n",
       "7    1053922973_7_I -0.228295\n",
       "8    1053922973_8_I -0.226454\n",
       "9    1053922973_9_I -0.144052\n",
       "10  1053922973_10_I -0.200585\n",
       "11  1053922973_11_I -0.571014\n",
       "12  1053922973_12_I -1.232349\n",
       "13  1053922973_13_I -1.956533\n",
       "14  1053922973_14_I -2.600490\n",
       "15  1053922973_15_I -2.744738\n",
       "16  1053922973_16_I -2.388441\n",
       "17  1053922973_17_I -1.694855\n",
       "18  1053922973_18_I -0.963314\n",
       "19  1053922973_19_I -0.377474\n",
       "20  1053922973_20_I -0.165994\n",
       "21  1053922973_21_I -0.175707\n",
       "22  1053922973_22_I -0.230672\n",
       "23  1053922973_23_I -0.230821\n",
       "24  1053922973_24_I -0.230940\n",
       "25  1053922973_25_I -0.230875\n",
       "26  1053922973_26_I -0.229927\n",
       "27  1053922973_27_I -0.227752\n",
       "28  1053922973_28_I -0.225159\n",
       "29  1053922973_29_I -0.163965"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import os\n",
    "import gc\n",
    "import cv2\n",
    "import torch\n",
    "import random\n",
    "import traceback\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "from tqdm import tqdm\n",
    "from pathlib import Path\n",
    "from tqdm.auto import tqdm\n",
    "from shutil import copyfile\n",
    "from scipy.signal import resample\n",
    "\n",
    "SEED = 42\n",
    "\n",
    "os.environ[\"PYTHONHASHSEED\"] = str(SEED)\n",
    "os.environ[\"CUBLAS_WORKSPACE_CONFIG\"] = \":4096:8\"\n",
    "\n",
    "random.seed(SEED)\n",
    "np.random.seed(SEED)\n",
    "\n",
    "torch.manual_seed(SEED)\n",
    "torch.cuda.manual_seed(SEED)\n",
    "torch.cuda.manual_seed_all(SEED)\n",
    "\n",
    "torch.backends.cudnn.deterministic = True\n",
    "torch.backends.cudnn.benchmark = False\n",
    "torch.use_deterministic_algorithms(True, warn_only=True)\n",
    "\n",
    "# save seed for reproducibility\n",
    "with open(\"/kaggle/working/seed.txt\", \"w\") as f:\n",
    "    f.write(str(SEED))\n",
    "\n",
    "\n",
    "from stage0_model import Net as Stage0Net\n",
    "from stage0_common import *\n",
    "\n",
    "test_dir = Path(\"/kaggle/input/physionet-ecg-image-digitization/test\")\n",
    "\n",
    "test = pd.read_csv(\"/kaggle/input/physionet-ecg-image-digitization/test.csv\")\n",
    "test['id'] = test['id'].astype(str) \n",
    "test_id = test['id'].unique().tolist()\n",
    "\n",
    "\n",
    "global_dict = {\n",
    "    \"stage0_dir\": \"/kaggle/working/stage0\",\n",
    "    \"stage1_dir\": \"/kaggle/working/stage1\",\n",
    "    \"stage2_dir\": \"/kaggle/working/stage2\",\n",
    "}\n",
    "\n",
    "def change_color(image_rgb):\n",
    "    hsv = cv2.cvtColor(image_rgb, cv2.COLOR_RGB2HSV)\n",
    "    h, s, v = cv2.split(hsv)\n",
    "    \n",
    "    v_denoised = cv2.fastNlMeansDenoising(v, h=6)\n",
    "    \n",
    "    std = np.std(v_denoised)\n",
    "    clip_limit = max(1.0, min(3.5, 2.0 + std / 25))\n",
    "    clahe = cv2.createCLAHE(clipLimit=clip_limit, tileGridSize=(8, 8))\n",
    "    v_enhanced = clahe.apply(v_denoised)\n",
    "    \n",
    "    hsv_enhanced = cv2.merge([h, s, v_enhanced])\n",
    "    return cv2.cvtColor(hsv_enhanced, cv2.COLOR_HSV2RGB)\n",
    "\n",
    "def dw(series_dict, alpha=0.33):\n",
    "    if all(k in series_dict for k in ['I', 'II', 'III']):\n",
    "        L1 = series_dict['I']\n",
    "        L2 = series_dict['II']\n",
    "        L3 = series_dict['III']\n",
    "\n",
    "        error = L2 - (L1 + L3)\n",
    "\n",
    "        series_dict['I'] = L1 + (alpha * error)\n",
    "        series_dict['III'] = L3 + (alpha * error)\n",
    "        series_dict['II'] = L2 - (alpha * error)\n",
    "    \n",
    "    return series_dict\n",
    "\n",
    "def series_to_dict_local(series_4row):\n",
    "    d = {}\n",
    "    names = [['I', 'aVR', 'V1', 'V4'], \n",
    "             ['II', 'aVL', 'V2', 'V5'], \n",
    "             ['III', 'aVF', 'V3', 'V6']]\n",
    "    \n",
    "    for i in range(3):\n",
    "        splits = np.array_split(series_4row[i], 4)\n",
    "        for name, data in zip(names[i], splits):\n",
    "            d[name] = data\n",
    "    \n",
    "    d['II_Long'] = series_4row[3]\n",
    "    return d\n",
    "\n",
    "def dict_to_series_local(d, original_shape):\n",
    "    new_series = np.zeros(original_shape)\n",
    "    new_series[0] = np.concatenate([d['I'], d['aVR'], d['V1'], d['V4']])\n",
    "    new_series[1] = np.concatenate([d['II'], d['aVL'], d['V2'], d['V5']])\n",
    "    new_series[2] = np.concatenate([d['III'], d['aVF'], d['V3'], d['V6']])\n",
    "    new_series[3] = d['II_Long']\n",
    "    \n",
    "    return new_series\n",
    "\n",
    "stage0_dir = Path(global_dict[\"stage0_dir\"])\n",
    "stage0_dir.mkdir(exist_ok=True)\n",
    "\n",
    "stage0_net = Stage0Net(pretrained=False)\n",
    "stage0_net = load_net(stage0_net, '/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/weight/stage0-last.checkpoint.pth')\n",
    "stage0_net.to(\"cuda:0\")\n",
    "stage0_net.eval()\n",
    "\n",
    "for n, sample_id in enumerate(tqdm(test_id)):\n",
    "    path = test_dir / f'{sample_id}.png'\n",
    "    output_path = stage0_dir / f'{sample_id}.png'\n",
    "    \n",
    "    image_original = cv2.imread(str(path), cv2.IMREAD_COLOR)\n",
    "    image_original = cv2.cvtColor(image_original, cv2.COLOR_BGR2RGB)\n",
    "    image_for_model = change_color(image_original)\n",
    "    \n",
    "    batch = image_to_batch(image_for_model)\n",
    "\n",
    "    try:\n",
    "        with torch.no_grad(), torch.amp.autocast('cuda', dtype=torch.float32):\n",
    "            output = stage0_net(batch)\n",
    "        \n",
    "        rotated, keypoint = output_to_predict(image_original, batch, output)\n",
    "        normalised, _, _ = normalise_by_homography(rotated, keypoint)\n",
    "        \n",
    "        cv2.imwrite(str(output_path), cv2.cvtColor(normalised, cv2.COLOR_RGB2BGR))\n",
    "    except Exception as e:\n",
    "        traceback.print_exc()\n",
    "        copyfile(path, output_path)\n",
    "\n",
    "\n",
    "from stage1_model import Net as Stage1Net\n",
    "from stage1_common import *\n",
    "\n",
    "stage0_dir = Path(global_dict[\"stage0_dir\"])\n",
    "stage1_dir = Path(global_dict[\"stage1_dir\"])\n",
    "stage1_dir.mkdir(exist_ok=True)\n",
    "\n",
    "stage1_net = Stage1Net(pretrained=False)\n",
    "stage1_net = load_net(stage1_net, '/kaggle/input/hengck23-submit-physionet/hengck23-submit-physionet/weight/stage1-last.checkpoint.pth')\n",
    "stage1_net.to(\"cuda:0\")\n",
    "\n",
    "for n, sample_id in enumerate(tqdm(test_id)):\n",
    "    path = stage0_dir / f'{sample_id}.png'\n",
    "    output_path = stage1_dir / f'{sample_id}.png'\n",
    "    image = cv2.imread(path, cv2.IMREAD_COLOR_RGB)\n",
    "    batch = {'image': torch.from_numpy(np.ascontiguousarray(image.transpose(2, 0, 1))).unsqueeze(0)}\n",
    "\n",
    "    try:\n",
    "        with torch.no_grad(), torch.amp.autocast('cuda', dtype=torch.float32):\n",
    "            output = stage1_net(batch)\n",
    "        gridpoint_xy, _ = output_to_predict(image, batch, output)\n",
    "        rectified = rectify_image(image, gridpoint_xy)\n",
    "        cv2.imwrite(output_path, cv2.cvtColor(rectified, cv2.COLOR_RGB2BGR))\n",
    "    except:\n",
    "        traceback.print_exc()\n",
    "        copyfile(path, output_path)\n",
    "\n",
    "import torchvision.transforms as T\n",
    "from stage2_model import *\n",
    "from stage2_common import *\n",
    "from scipy.signal import savgol_filter, medfilt\n",
    "\n",
    "\n",
    "class Net3(nn.Module):\n",
    "    \n",
    "    def __init__(self, pretrained=True):\n",
    "        super(Net3, self).__init__()\n",
    "        encoder_dim = [64, 128, 256, 512]\n",
    "        decoder_dim = [128, 64, 32, 16]\n",
    "\n",
    "        self.encoder = timm.create_model(\n",
    "            model_name='resnet34.a3_in1k', pretrained=pretrained, in_chans=3, num_classes=0, global_pool=''\n",
    "        )\n",
    "\n",
    "        self.decoder = MyCoordUnetDecoder(\n",
    "            in_channel=encoder_dim[-1],\n",
    "            skip_channel=encoder_dim[:-1][::-1] + [0],\n",
    "            out_channel=decoder_dim,\n",
    "            scale=[2, 2, 2, 2]\n",
    "        )\n",
    "        self.pixel = nn.Conv2d(decoder_dim[-1], 4, 1)\n",
    "\n",
    "    def forward(self, image):\n",
    "        encode = encode_with_resnet(self.encoder, image)\n",
    "        last, _ = self.decoder(feature=encode[-1], skip=encode[:-1][::-1] + [None])\n",
    "        pixel = self.pixel(last)\n",
    "        return pixel\n",
    "\n",
    "stage1_dir = Path(global_dict[\"stage1_dir\"])\n",
    "stage2_dir = Path(global_dict[\"stage2_dir\"])\n",
    "stage2_dir.mkdir(exist_ok=True)\n",
    "\n",
    "stage2_net = Net3(pretrained=False).to(\"cuda:0\")\n",
    "model_path = \"/kaggle/input/physio-seg-public/pytorch/net3_009_4200/1/iter_0004200.pt\"\n",
    "stage2_net.load_state_dict(torch.load(model_path))\n",
    "stage2_net.eval()\n",
    "\n",
    "x0, x1 = 0, 2176\n",
    "y0, y1 = 0, 1696\n",
    "zero_mv = [703.5, 987.5, 1271.5, 1531.5]\n",
    "mv_to_pixel = 78.66\n",
    "t0, t1 = 235, 4161\n",
    "\n",
    "resize = T.Resize((1696, 4352), interpolation=T.InterpolationMode.BILINEAR)\n",
    "\n",
    "for n, sample_id in enumerate(tqdm(test_id)):\n",
    "    path = stage1_dir / f'{sample_id}.png'\n",
    "    output_path = stage2_dir / f'{sample_id}.npy'\n",
    "    image = cv2.imread(path, cv2.IMREAD_COLOR_RGB)\n",
    "    \n",
    "    length = test[(test['id']==sample_id) & (test['lead']=='II')].iloc[0].number_of_rows\n",
    "    \n",
    "    image = image[y0:y1, x0:x1] / 255\n",
    "    batch = resize(torch.from_numpy(np.ascontiguousarray(image.transpose(2, 0, 1))).unsqueeze(0)).float().to(\"cuda:0\")\n",
    "    \n",
    "    try:\n",
    "        with torch.no_grad(), torch.amp.autocast('cuda', dtype=torch.float32):\n",
    "            output = stage2_net(batch)\n",
    "        \n",
    "        pixel = torch.sigmoid(output).float().data.cpu().numpy()[0]\n",
    "        series_in_pixel = pixel_to_series(pixel[..., t0:t1], zero_mv, length)\n",
    "        series = (np.array(zero_mv).reshape(4, 1) - series_in_pixel) / mv_to_pixel\n",
    "        \n",
    "        for i in range(series.shape[0]):\n",
    "            series[i] = savgol_filter(series[i], window_length=7, polyorder=2)\n",
    "        \n",
    "        s_dict = series_to_dict_local(series)\n",
    "        s_dict = dw(s_dict)\n",
    "        series = dict_to_series_local(s_dict, series.shape)\n",
    "\n",
    "        np.save(output_path, series)\n",
    "    except:\n",
    "        traceback.print_exc()\n",
    "        series = np.zeros((4, length)) \n",
    "        np.save(output_path, series)\n",
    "\n",
    "def series_dict(series):\n",
    "    d = {}\n",
    "    for l in range(3):\n",
    "        lead_names = [\n",
    "            ['I',   'aVR', 'V1', 'V4'],\n",
    "            ['II',  'aVL', 'V2', 'V5'],\n",
    "            ['III', 'aVF', 'V3', 'V6'],\n",
    "        ][l]\n",
    "        split = np.array_split(series[l], 4)\n",
    "        for (k, s) in zip(lead_names, split):\n",
    "            d[k] = s\n",
    "    \n",
    "    d['II'] = series[3]\n",
    "    \n",
    "    return d\n",
    "\n",
    "\n",
    "stage2_dir = Path(global_dict[\"stage2_dir\"])\n",
    "\n",
    "res = []\n",
    "gb = test.groupby('id')\n",
    "\n",
    "for i, (sample_id, df) in enumerate(tqdm(gb)):\n",
    "    series = np.load(stage2_dir / f'{sample_id}.npy')\n",
    "    d_series = series_dict(series)\n",
    "\n",
    "    for _, d in df.iterrows():\n",
    "        s = d_series.get(d.lead, np.zeros(d.number_of_rows))\n",
    "        \n",
    "        if len(s) != d.number_of_rows:\n",
    "            x_old = np.linspace(0, 1, len(s))\n",
    "            x_new = np.linspace(0, 1, d.number_of_rows)\n",
    "            s = np.interp(x_new, x_old, s)\n",
    "        \n",
    "        row_id = [f'{sample_id}_{x}_{d.lead}' for x in range(d.number_of_rows)]\n",
    "        res.append(pd.DataFrame({'id': row_id, 'value': s}))\n",
    "\n",
    "    if i % 100 == 0:\n",
    "        gc.collect()\n",
    "\n",
    "submission = pd.concat(res, axis=0, ignore_index=True)\n",
    "submission.to_csv('submission.csv', index=False)\n",
    "submission.head(30)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "281772f4",
   "metadata": {
    "papermill": {
     "duration": 0.003618,
     "end_time": "2026-01-10T04:43:49.091025",
     "exception": false,
     "start_time": "2026-01-10T04:43:49.087407",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### please upvote"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "06ccdfa8",
   "metadata": {
    "papermill": {
     "duration": 0.002594,
     "end_time": "2026-01-10T04:43:49.096285",
     "exception": false,
     "start_time": "2026-01-10T04:43:49.093691",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "feed233d",
   "metadata": {
    "papermill": {
     "duration": 0.002605,
     "end_time": "2026-01-10T04:43:49.101528",
     "exception": false,
     "start_time": "2026-01-10T04:43:49.098923",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "databundleVersionId": 14096757,
     "sourceId": 97984,
     "sourceType": "competition"
    },
    {
     "datasetId": 8747012,
     "sourceId": 13746387,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 8620533,
     "sourceId": 13816899,
     "sourceType": "datasetVersion"
    },
    {
     "isSourceIdPinned": true,
     "modelId": 528480,
     "modelInstanceId": 513841,
     "sourceId": 677607,
     "sourceType": "modelInstanceVersion"
    }
   ],
   "dockerImageVersionId": 31236,
   "isGpuEnabled": true,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 59.074151,
   "end_time": "2026-01-10T04:43:52.366032",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2026-01-10T04:42:53.291881",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "012154ec8da4462794122c560b46c175": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_478e62f2ea544119b00150ba66e29abf",
       "placeholder": "​",
       "style": "IPY_MODEL_1c633d1d69c54cd4b3ebc308e3b62343",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:07&lt;00:00,  3.47s/it]"
      }
     },
     "089aa1a5f52d4c408c98702475c078f5": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_b45350ebcdfb4fb28765ba6ac7b87dae",
        "IPY_MODEL_3b6c02d84e6244d9b8e025d474ca4221",
        "IPY_MODEL_d206004c41d144b99066de94b2a7681b"
       ],
       "layout": "IPY_MODEL_407e6558e3c44847b7e3ec1e6c460f30",
       "tabbable": null,
       "tooltip": null
      }
     },
     "0b227f639b5042b5915d5ed2cbf496e8": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "16709663fc5a43f3a1b59135fd051ea3": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_99ae4985003c4055b529f3e52b7878f4",
       "placeholder": "​",
       "style": "IPY_MODEL_eb5c0edad1e04744bf061f2c6778a540",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "1c633d1d69c54cd4b3ebc308e3b62343": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "1c6e800aea7444b98ce8d7800d1b4a72": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_eff8bc791f074c85afb744db3d25aae5",
        "IPY_MODEL_facc8a7122124f429f775638efe95ab3",
        "IPY_MODEL_012154ec8da4462794122c560b46c175"
       ],
       "layout": "IPY_MODEL_31dac16f79ea4b74b302cc2a5e25c2bb",
       "tabbable": null,
       "tooltip": null
      }
     },
     "2678d5e353ee43958de200ba3a851bd8": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_4deaccc40d054604b1dc2d7adb7b7f5e",
       "placeholder": "​",
       "style": "IPY_MODEL_ff815bc047ca45e39b81d5cc07e5bf16",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "2857e2ec2d134e0aade0a1aea1ae856f": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "2cef7dff25fb4f5eb06b7e2f922fea5b": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "31dac16f79ea4b74b302cc2a5e25c2bb": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "34680775d4ba41c58376cd9eccf810ff": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "37fb8cbef2ea455a836ff9417cb3f16a": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "3b6c02d84e6244d9b8e025d474ca4221": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_2857e2ec2d134e0aade0a1aea1ae856f",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_34680775d4ba41c58376cd9eccf810ff",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "407e6558e3c44847b7e3ec1e6c460f30": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "430e4788e76249f0991d6b6bc864a6fa": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "478e62f2ea544119b00150ba66e29abf": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "4deaccc40d054604b1dc2d7adb7b7f5e": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "549c67a2e8414ffeada9048002ddb71e": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "5a65a7fdb6eb413c90507a7348d24fd9": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "632a0a4662844d95b645b13f54a58c42": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "65e4f0333ec642bc9a625a9c8ef6e6dc": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7107e6b3be884bdc89172143dc03a27d": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "76de2a3126e94b6882fc9a16848cb2e4": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "78dc7a27368b47c28d23a3a7a01d1d23": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_16709663fc5a43f3a1b59135fd051ea3",
        "IPY_MODEL_c3b40c418bbc432eb795f1489a145ac8",
        "IPY_MODEL_adab48aa8f374271858c322395dc51fc"
       ],
       "layout": "IPY_MODEL_632a0a4662844d95b645b13f54a58c42",
       "tabbable": null,
       "tooltip": null
      }
     },
     "9104dbed747943d3a0c47538eb037e1e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_bf6c14e1c5d54f52a2ab6c888dbf0fba",
       "placeholder": "​",
       "style": "IPY_MODEL_e4eaefe85a4a4fd09132008e3e7181d3",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:00&lt;00:00,  3.54it/s]"
      }
     },
     "914a0ba118844b22bddad8a9e3169e3f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "96072dd37b5f48c2a396c13d63b2cdad": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "99ae4985003c4055b529f3e52b7878f4": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "a3a982842ca74c5193b8ae6c2f2e9738": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "adab48aa8f374271858c322395dc51fc": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_76de2a3126e94b6882fc9a16848cb2e4",
       "placeholder": "​",
       "style": "IPY_MODEL_0b227f639b5042b5915d5ed2cbf496e8",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:00&lt;00:00,  4.28it/s]"
      }
     },
     "b45350ebcdfb4fb28765ba6ac7b87dae": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_2cef7dff25fb4f5eb06b7e2f922fea5b",
       "placeholder": "​",
       "style": "IPY_MODEL_a3a982842ca74c5193b8ae6c2f2e9738",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "bbcbf1d7a5124a7891642ebc71d16808": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_2678d5e353ee43958de200ba3a851bd8",
        "IPY_MODEL_df8731d9c38c4dc8a1f115af986d9044",
        "IPY_MODEL_9104dbed747943d3a0c47538eb037e1e"
       ],
       "layout": "IPY_MODEL_7107e6b3be884bdc89172143dc03a27d",
       "tabbable": null,
       "tooltip": null
      }
     },
     "bf6c14e1c5d54f52a2ab6c888dbf0fba": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "c3b40c418bbc432eb795f1489a145ac8": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_ce4c2b6b9ae8481fbdd2dfeb668c12a9",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_430e4788e76249f0991d6b6bc864a6fa",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "ce4c2b6b9ae8481fbdd2dfeb668c12a9": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "d206004c41d144b99066de94b2a7681b": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_d7cb8692d5d54204805c7a2ecd9becd2",
       "placeholder": "​",
       "style": "IPY_MODEL_37fb8cbef2ea455a836ff9417cb3f16a",
       "tabbable": null,
       "tooltip": null,
       "value": " 2/2 [00:03&lt;00:00,  1.85s/it]"
      }
     },
     "d42a57aa7c1b46528bdf69abd73e2dbf": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "d7cb8692d5d54204805c7a2ecd9becd2": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "df8731d9c38c4dc8a1f115af986d9044": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_65e4f0333ec642bc9a625a9c8ef6e6dc",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_d42a57aa7c1b46528bdf69abd73e2dbf",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "e4eaefe85a4a4fd09132008e3e7181d3": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "eb5c0edad1e04744bf061f2c6778a540": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "eff8bc791f074c85afb744db3d25aae5": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_549c67a2e8414ffeada9048002ddb71e",
       "placeholder": "​",
       "style": "IPY_MODEL_96072dd37b5f48c2a396c13d63b2cdad",
       "tabbable": null,
       "tooltip": null,
       "value": "100%"
      }
     },
     "facc8a7122124f429f775638efe95ab3": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_5a65a7fdb6eb413c90507a7348d24fd9",
       "max": 2.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_914a0ba118844b22bddad8a9e3169e3f",
       "tabbable": null,
       "tooltip": null,
       "value": 2.0
      }
     },
     "ff815bc047ca45e39b81d5cc07e5bf16": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
