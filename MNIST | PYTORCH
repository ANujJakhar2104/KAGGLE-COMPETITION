{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/anujjakhar2104/mnist-pytorch?scriptVersionId=294715326\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"b138e971","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2026-01-29T08:17:02.313647Z","iopub.status.busy":"2026-01-29T08:17:02.313396Z","iopub.status.idle":"2026-01-29T08:17:07.681708Z","shell.execute_reply":"2026-01-29T08:17:07.681099Z"},"papermill":{"duration":5.375035,"end_time":"2026-01-29T08:17:07.683422","exception":false,"start_time":"2026-01-29T08:17:02.308387","status":"completed"},"tags":[]},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import torch\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.model_selection import train_test_split\n","import torch.nn as nn\n","import torch.optim as optim"]},{"cell_type":"code","execution_count":2,"id":"47ae6b25","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:07.692084Z","iopub.status.busy":"2026-01-29T08:17:07.69125Z","iopub.status.idle":"2026-01-29T08:17:12.506281Z","shell.execute_reply":"2026-01-29T08:17:12.50556Z"},"papermill":{"duration":4.821134,"end_time":"2026-01-29T08:17:12.508195","exception":false,"start_time":"2026-01-29T08:17:07.687061","status":"completed"},"tags":[]},"outputs":[],"source":["train_df = pd.read_csv('/kaggle/input/fashionmnist/fashion-mnist_train.csv')\n","test_df = pd.read_csv('/kaggle/input/fashionmnist/fashion-mnist_test.csv')"]},{"cell_type":"code","execution_count":3,"id":"34a37b40","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.517453Z","iopub.status.busy":"2026-01-29T08:17:12.516829Z","iopub.status.idle":"2026-01-29T08:17:12.552829Z","shell.execute_reply":"2026-01-29T08:17:12.551985Z"},"papermill":{"duration":0.042346,"end_time":"2026-01-29T08:17:12.554597","exception":false,"start_time":"2026-01-29T08:17:12.512251","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>pixel1</th>\n","      <th>pixel2</th>\n","      <th>pixel3</th>\n","      <th>pixel4</th>\n","      <th>pixel5</th>\n","      <th>pixel6</th>\n","      <th>pixel7</th>\n","      <th>pixel8</th>\n","      <th>pixel9</th>\n","      <th>...</th>\n","      <th>pixel775</th>\n","      <th>pixel776</th>\n","      <th>pixel777</th>\n","      <th>pixel778</th>\n","      <th>pixel779</th>\n","      <th>pixel780</th>\n","      <th>pixel781</th>\n","      <th>pixel782</th>\n","      <th>pixel783</th>\n","      <th>pixel784</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>9</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>30</td>\n","      <td>43</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>59995</th>\n","      <td>9</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>59996</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>73</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>59997</th>\n","      <td>8</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>160</td>\n","      <td>162</td>\n","      <td>163</td>\n","      <td>135</td>\n","      <td>94</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>59998</th>\n","      <td>8</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>59999</th>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>60000 rows Ã— 785 columns</p>\n","</div>"],"text/plain":["       label  pixel1  pixel2  pixel3  pixel4  pixel5  pixel6  pixel7  pixel8  \\\n","0          2       0       0       0       0       0       0       0       0   \n","1          9       0       0       0       0       0       0       0       0   \n","2          6       0       0       0       0       0       0       0       5   \n","3          0       0       0       0       1       2       0       0       0   \n","4          3       0       0       0       0       0       0       0       0   \n","...      ...     ...     ...     ...     ...     ...     ...     ...     ...   \n","59995      9       0       0       0       0       0       0       0       0   \n","59996      1       0       0       0       0       0       0       0       0   \n","59997      8       0       0       0       0       0       0       0       0   \n","59998      8       0       0       0       0       0       0       0       0   \n","59999      7       0       0       0       0       0       0       0       0   \n","\n","       pixel9  ...  pixel775  pixel776  pixel777  pixel778  pixel779  \\\n","0           0  ...         0         0         0         0         0   \n","1           0  ...         0         0         0         0         0   \n","2           0  ...         0         0         0        30        43   \n","3           0  ...         3         0         0         0         0   \n","4           0  ...         0         0         0         0         0   \n","...       ...  ...       ...       ...       ...       ...       ...   \n","59995       0  ...         0         0         0         0         0   \n","59996       0  ...        73         0         0         0         0   \n","59997       0  ...       160       162       163       135        94   \n","59998       0  ...         0         0         0         0         0   \n","59999       0  ...         0         0         0         0         0   \n","\n","       pixel780  pixel781  pixel782  pixel783  pixel784  \n","0             0         0         0         0         0  \n","1             0         0         0         0         0  \n","2             0         0         0         0         0  \n","3             1         0         0         0         0  \n","4             0         0         0         0         0  \n","...         ...       ...       ...       ...       ...  \n","59995         0         0         0         0         0  \n","59996         0         0         0         0         0  \n","59997         0         0         0         0         0  \n","59998         0         0         0         0         0  \n","59999         0         0         0         0         0  \n","\n","[60000 rows x 785 columns]"]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["train_df"]},{"cell_type":"code","execution_count":4,"id":"d808d866","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.564991Z","iopub.status.busy":"2026-01-29T08:17:12.564478Z","iopub.status.idle":"2026-01-29T08:17:12.641588Z","shell.execute_reply":"2026-01-29T08:17:12.640906Z"},"papermill":{"duration":0.083442,"end_time":"2026-01-29T08:17:12.64291","exception":false,"start_time":"2026-01-29T08:17:12.559468","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["device(type='cuda')"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","device"]},{"cell_type":"code","execution_count":5,"id":"4bdfd34d","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.651413Z","iopub.status.busy":"2026-01-29T08:17:12.650971Z","iopub.status.idle":"2026-01-29T08:17:12.780411Z","shell.execute_reply":"2026-01-29T08:17:12.77979Z"},"papermill":{"duration":0.135573,"end_time":"2026-01-29T08:17:12.782182","exception":false,"start_time":"2026-01-29T08:17:12.646609","status":"completed"},"tags":[]},"outputs":[],"source":["# Splitting features (pixels) and labels (categories)\n","x_train = train_df.drop('label', axis=1).to_numpy()\n","y_train = train_df['label'].to_numpy()\n","\n","x_test = test_df.drop('label', axis=1).to_numpy()\n","y_test = test_df['label'].to_numpy()"]},{"cell_type":"code","execution_count":6,"id":"3a28ef71","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.792408Z","iopub.status.busy":"2026-01-29T08:17:12.791907Z","iopub.status.idle":"2026-01-29T08:17:12.795085Z","shell.execute_reply":"2026-01-29T08:17:12.794522Z"},"papermill":{"duration":0.010024,"end_time":"2026-01-29T08:17:12.796515","exception":false,"start_time":"2026-01-29T08:17:12.786491","status":"completed"},"tags":[]},"outputs":[],"source":["from torch.utils.data import Dataset , DataLoader"]},{"cell_type":"code","execution_count":7,"id":"b7bf61af","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.804557Z","iopub.status.busy":"2026-01-29T08:17:12.804261Z","iopub.status.idle":"2026-01-29T08:17:12.830337Z","shell.execute_reply":"2026-01-29T08:17:12.829683Z"},"papermill":{"duration":0.031599,"end_time":"2026-01-29T08:17:12.831684","exception":false,"start_time":"2026-01-29T08:17:12.800085","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 60000 entries, 0 to 59999\n","Columns: 785 entries, label to pixel784\n","dtypes: int64(785)\n","memory usage: 359.3 MB\n"]}],"source":["train_df.info()"]},{"cell_type":"code","execution_count":8,"id":"4ab2eb88","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.839877Z","iopub.status.busy":"2026-01-29T08:17:12.83946Z","iopub.status.idle":"2026-01-29T08:17:12.843714Z","shell.execute_reply":"2026-01-29T08:17:12.843157Z"},"papermill":{"duration":0.009717,"end_time":"2026-01-29T08:17:12.84498","exception":false,"start_time":"2026-01-29T08:17:12.835263","status":"completed"},"tags":[]},"outputs":[],"source":["class MyDataset(Dataset):\n","\n","    def __init__(self , features , labels):\n","        self.features = torch.tensor(features , dtype = torch.float64)\n","        self.labels = torch.tensor(labels , dtype = torch.float64)\n","\n","    def __len__(self):\n","        return len(self.features)\n","\n","    def __getitem__(self, idx):\n","        x = self.features[idx]\n","        y = self.labels[idx]\n","\n","        x = x.float()\n","        y = y.long()\n","\n","        return x, y"]},{"cell_type":"code","execution_count":9,"id":"7ce7a3ca","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:12.853839Z","iopub.status.busy":"2026-01-29T08:17:12.853332Z","iopub.status.idle":"2026-01-29T08:17:13.041007Z","shell.execute_reply":"2026-01-29T08:17:13.040402Z"},"papermill":{"duration":0.193565,"end_time":"2026-01-29T08:17:13.042714","exception":false,"start_time":"2026-01-29T08:17:12.849149","status":"completed"},"tags":[]},"outputs":[],"source":["df_train_dataset = MyDataset(x_train , y_train)\n","df_test_dataset = MyDataset(x_test , y_test)"]},{"cell_type":"code","execution_count":10,"id":"c31db76e","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:13.051391Z","iopub.status.busy":"2026-01-29T08:17:13.051096Z","iopub.status.idle":"2026-01-29T08:17:13.055045Z","shell.execute_reply":"2026-01-29T08:17:13.054486Z"},"papermill":{"duration":0.009813,"end_time":"2026-01-29T08:17:13.056411","exception":false,"start_time":"2026-01-29T08:17:13.046598","status":"completed"},"tags":[]},"outputs":[],"source":["train_loader = DataLoader(df_train_dataset , batch_size = 100 , shuffle = True , pin_memory = True)\n","test_loader = DataLoader(df_test_dataset , batch_size = 100 , shuffle = True , pin_memory = True)"]},{"cell_type":"markdown","id":"955e579e","metadata":{"papermill":{"duration":0.003553,"end_time":"2026-01-29T08:17:13.063583","exception":false,"start_time":"2026-01-29T08:17:13.06003","status":"completed"},"tags":[]},"source":["## CNN"]},{"cell_type":"code","execution_count":11,"id":"c0f5c7bb","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:13.071818Z","iopub.status.busy":"2026-01-29T08:17:13.071593Z","iopub.status.idle":"2026-01-29T08:17:13.076016Z","shell.execute_reply":"2026-01-29T08:17:13.075399Z"},"papermill":{"duration":0.010389,"end_time":"2026-01-29T08:17:13.077511","exception":false,"start_time":"2026-01-29T08:17:13.067122","status":"completed"},"tags":[]},"outputs":[],"source":["class myCnn(nn.Module):\n","\n","    def __init__(self , num_features):\n","        super().__init__()\n","        self.model = nn.Sequential(\n","            nn.Linear(num_features , 128),\n","            nn.BatchNorm1d(128),\n","            nn.ReLU(),\n","            nn.Dropout(p=0.2),\n","            nn.Linear(128,64),\n","            nn.BatchNorm1d(64),\n","            nn.ReLU(),\n","            nn.Dropout(p=0.2),\n","            nn.Linear(64 , 10)\n","        )\n","\n","    def forward(self , x):\n","        return self.model(x)\n"]},{"cell_type":"code","execution_count":12,"id":"9b4d6c6e","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:13.086049Z","iopub.status.busy":"2026-01-29T08:17:13.085493Z","iopub.status.idle":"2026-01-29T08:17:13.088767Z","shell.execute_reply":"2026-01-29T08:17:13.08813Z"},"papermill":{"duration":0.008876,"end_time":"2026-01-29T08:17:13.090175","exception":false,"start_time":"2026-01-29T08:17:13.081299","status":"completed"},"tags":[]},"outputs":[],"source":["learning_rate = 0.01\n","epochs = 100"]},{"cell_type":"code","execution_count":13,"id":"a99a9f4b","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:13.098451Z","iopub.status.busy":"2026-01-29T08:17:13.098061Z","iopub.status.idle":"2026-01-29T08:17:17.63516Z","shell.execute_reply":"2026-01-29T08:17:17.634584Z"},"papermill":{"duration":4.543133,"end_time":"2026-01-29T08:17:17.636914","exception":false,"start_time":"2026-01-29T08:17:13.093781","status":"completed"},"tags":[]},"outputs":[],"source":["model = myCnn(x_train.shape[1])\n","model = model.to(device)\n","criterion = nn.CrossEntropyLoss()\n","optimizer = optim.Adam(model.parameters(), lr=learning_rate , weight_decay = 1e-4)"]},{"cell_type":"code","execution_count":14,"id":"870a1e76","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:17.645973Z","iopub.status.busy":"2026-01-29T08:17:17.645265Z","iopub.status.idle":"2026-01-29T08:17:17.649762Z","shell.execute_reply":"2026-01-29T08:17:17.649186Z"},"papermill":{"duration":0.010203,"end_time":"2026-01-29T08:17:17.651059","exception":false,"start_time":"2026-01-29T08:17:17.640856","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["myCnn(\n","  (model): Sequential(\n","    (0): Linear(in_features=784, out_features=128, bias=True)\n","    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (2): ReLU()\n","    (3): Dropout(p=0.2, inplace=False)\n","    (4): Linear(in_features=128, out_features=64, bias=True)\n","    (5): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n","    (6): ReLU()\n","    (7): Dropout(p=0.2, inplace=False)\n","    (8): Linear(in_features=64, out_features=10, bias=True)\n","  )\n",")"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["model"]},{"cell_type":"code","execution_count":15,"id":"69e656ef","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:17:17.659509Z","iopub.status.busy":"2026-01-29T08:17:17.659273Z","iopub.status.idle":"2026-01-29T08:22:23.934105Z","shell.execute_reply":"2026-01-29T08:22:23.933328Z"},"papermill":{"duration":306.289403,"end_time":"2026-01-29T08:22:23.944155","exception":false,"start_time":"2026-01-29T08:17:17.654752","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch: 1, Loss: 0.5392746700843175\n","Epoch: 2, Loss: 0.4535580284893513\n","Epoch: 3, Loss: 0.4463465072462956\n","Epoch: 4, Loss: 0.44020733716587224\n","Epoch: 5, Loss: 0.4414316006501516\n","Epoch: 6, Loss: 0.4415578917910655\n","Epoch: 7, Loss: 0.43843702097733817\n","Epoch: 8, Loss: 0.4371420579155286\n","Epoch: 9, Loss: 0.43441302845875424\n","Epoch: 10, Loss: 0.43460477456450464\n","Epoch: 11, Loss: 0.4388383296132088\n","Epoch: 12, Loss: 0.4282431530455748\n","Epoch: 13, Loss: 0.4346396571894487\n","Epoch: 14, Loss: 0.43673341458042464\n","Epoch: 15, Loss: 0.4342073157429695\n","Epoch: 16, Loss: 0.4321711486329635\n","Epoch: 17, Loss: 0.43397654426594573\n","Epoch: 18, Loss: 0.4325762405494849\n","Epoch: 19, Loss: 0.43298029551903405\n","Epoch: 20, Loss: 0.43464215613901613\n","Epoch: 21, Loss: 0.43356552951037886\n","Epoch: 22, Loss: 0.43411913365125654\n","Epoch: 23, Loss: 0.43673093830545745\n","Epoch: 24, Loss: 0.4290601681917906\n","Epoch: 25, Loss: 0.4280433491120736\n","Epoch: 26, Loss: 0.4267547576129436\n","Epoch: 27, Loss: 0.4344807104766369\n","Epoch: 28, Loss: 0.4294565866142511\n","Epoch: 29, Loss: 0.42926176788906256\n","Epoch: 30, Loss: 0.426388037626942\n","Epoch: 31, Loss: 0.4310271012286345\n","Epoch: 32, Loss: 0.4300651492923498\n","Epoch: 33, Loss: 0.4333301689724127\n","Epoch: 34, Loss: 0.43155099131166935\n","Epoch: 35, Loss: 0.43102351017296314\n","Epoch: 36, Loss: 0.4292275007814169\n","Epoch: 37, Loss: 0.42572805561125276\n","Epoch: 38, Loss: 0.42759215806921325\n","Epoch: 39, Loss: 0.4298579916357994\n","Epoch: 40, Loss: 0.4285644792020321\n","Epoch: 41, Loss: 0.43102201697727044\n","Epoch: 42, Loss: 0.429063660800457\n","Epoch: 43, Loss: 0.4316829499353965\n","Epoch: 44, Loss: 0.4228652259459098\n","Epoch: 45, Loss: 0.42656119031210743\n","Epoch: 46, Loss: 0.4315131482233604\n","Epoch: 47, Loss: 0.42711090698838233\n","Epoch: 48, Loss: 0.4280104596912861\n","Epoch: 49, Loss: 0.42988041882713635\n","Epoch: 50, Loss: 0.4298004206518332\n","Epoch: 51, Loss: 0.43032233414550625\n","Epoch: 52, Loss: 0.42982800741990407\n","Epoch: 53, Loss: 0.4310718187193076\n","Epoch: 54, Loss: 0.42835511768857637\n","Epoch: 55, Loss: 0.4304045534878969\n","Epoch: 56, Loss: 0.42693669627110165\n","Epoch: 57, Loss: 0.4281546890238921\n","Epoch: 58, Loss: 0.43105292963484926\n","Epoch: 59, Loss: 0.4292075837900241\n","Epoch: 60, Loss: 0.4260920157531897\n","Epoch: 61, Loss: 0.42848667812844116\n","Epoch: 62, Loss: 0.4320859878261884\n","Epoch: 63, Loss: 0.42714620364209016\n","Epoch: 64, Loss: 0.4297654721637567\n","Epoch: 65, Loss: 0.42804345185558\n","Epoch: 66, Loss: 0.4316939530024926\n","Epoch: 67, Loss: 0.430146958976984\n","Epoch: 68, Loss: 0.4284121222545703\n","Epoch: 69, Loss: 0.4272612465421359\n","Epoch: 70, Loss: 0.4312623827407757\n","Epoch: 71, Loss: 0.42984041184186933\n","Epoch: 72, Loss: 0.42804040205975374\n","Epoch: 73, Loss: 0.4275592380265395\n","Epoch: 74, Loss: 0.4326305424173673\n","Epoch: 75, Loss: 0.42680851340293885\n","Epoch: 76, Loss: 0.4344789426525434\n","Epoch: 77, Loss: 0.42575358229378857\n","Epoch: 78, Loss: 0.42750243961811063\n","Epoch: 79, Loss: 0.4329681688795487\n","Epoch: 80, Loss: 0.42570756596823534\n","Epoch: 81, Loss: 0.42815675695737204\n","Epoch: 82, Loss: 0.42838050700724123\n","Epoch: 83, Loss: 0.42824744028349715\n","Epoch: 84, Loss: 0.4278670175373554\n","Epoch: 85, Loss: 0.4327545566360156\n","Epoch: 86, Loss: 0.4281657122075558\n","Epoch: 87, Loss: 0.4282563297947248\n","Epoch: 88, Loss: 0.42837363101542\n","Epoch: 89, Loss: 0.4283035243799289\n","Epoch: 90, Loss: 0.4269926068931818\n","Epoch: 91, Loss: 0.43047428779304026\n","Epoch: 92, Loss: 0.433736335337162\n","Epoch: 93, Loss: 0.4311375797539949\n","Epoch: 94, Loss: 0.4312438108772039\n","Epoch: 95, Loss: 0.4282251459856828\n","Epoch: 96, Loss: 0.43147807647784553\n","Epoch: 97, Loss: 0.42777430010338624\n","Epoch: 98, Loss: 0.42990421478947005\n","Epoch: 99, Loss: 0.43016535761455693\n","Epoch: 100, Loss: 0.4277763310819864\n"]}],"source":["for epoch in range(epochs):\n","    total_epoch_loss = 0.0\n","\n","    for batch_features, labels in train_loader:\n","        batch_features, labels = batch_features.to(device), labels.to(device)\n","        out = model(batch_features)\n","        loss = criterion(out, labels)\n","\n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()\n","\n","        total_epoch_loss += loss.item()\n","\n","    avg_loss = total_epoch_loss / len(train_loader)\n","    print(f\"Epoch: {epoch + 1}, Loss: {avg_loss}\")\n","\n"]},{"cell_type":"markdown","id":"2e3a36be","metadata":{"papermill":{"duration":0.007053,"end_time":"2026-01-29T08:22:23.958497","exception":false,"start_time":"2026-01-29T08:22:23.951444","status":"completed"},"tags":[]},"source":["## evaluating"]},{"cell_type":"code","execution_count":16,"id":"13a40e66","metadata":{"execution":{"iopub.execute_input":"2026-01-29T08:22:23.973488Z","iopub.status.busy":"2026-01-29T08:22:23.973213Z","iopub.status.idle":"2026-01-29T08:22:24.366284Z","shell.execute_reply":"2026-01-29T08:22:24.365696Z"},"papermill":{"duration":0.402516,"end_time":"2026-01-29T08:22:24.367917","exception":false,"start_time":"2026-01-29T08:22:23.965401","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["avg accuracy : 0.8666\n"]}],"source":["model.eval()\n","total = 0\n","correct =0\n","\n","with torch.no_grad():\n","    for batch_features , labels in test_loader:\n","        batch_features, labels = batch_features.to(device), labels.to(device)\n","    \n","        out = model(batch_features)\n","        _, predicted = torch.max(out, 1)\n","\n","        total += labels.size(0)\n","        correct += (predicted == labels).sum().item()\n","\n","    print(f'avg accuracy : {correct/total}')"]},{"cell_type":"code","execution_count":null,"id":"808953bf","metadata":{"papermill":{"duration":0.007157,"end_time":"2026-01-29T08:22:24.382645","exception":false,"start_time":"2026-01-29T08:22:24.375488","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"e63fb355","metadata":{"papermill":{"duration":0.007213,"end_time":"2026-01-29T08:22:24.396809","exception":false,"start_time":"2026-01-29T08:22:24.389596","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"5d97f346","metadata":{"papermill":{"duration":0.007008,"end_time":"2026-01-29T08:22:24.411272","exception":false,"start_time":"2026-01-29T08:22:24.404264","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"38f0be81","metadata":{"papermill":{"duration":0.006947,"end_time":"2026-01-29T08:22:24.425644","exception":false,"start_time":"2026-01-29T08:22:24.418697","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"6321dcf2","metadata":{"papermill":{"duration":0.007113,"end_time":"2026-01-29T08:22:24.439678","exception":false,"start_time":"2026-01-29T08:22:24.432565","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"69fc7e52","metadata":{"papermill":{"duration":0.007018,"end_time":"2026-01-29T08:22:24.453753","exception":false,"start_time":"2026-01-29T08:22:24.446735","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"c08b0a6b","metadata":{"papermill":{"duration":0.006946,"end_time":"2026-01-29T08:22:24.467622","exception":false,"start_time":"2026-01-29T08:22:24.460676","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"c7292dfd","metadata":{"papermill":{"duration":0.007319,"end_time":"2026-01-29T08:22:24.482156","exception":false,"start_time":"2026-01-29T08:22:24.474837","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"cbc4fe6f","metadata":{"papermill":{"duration":0.007205,"end_time":"2026-01-29T08:22:24.496501","exception":false,"start_time":"2026-01-29T08:22:24.489296","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"a904c288","metadata":{"papermill":{"duration":0.006907,"end_time":"2026-01-29T08:22:24.51055","exception":false,"start_time":"2026-01-29T08:22:24.503643","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"736b31f9","metadata":{"papermill":{"duration":0.006977,"end_time":"2026-01-29T08:22:24.524544","exception":false,"start_time":"2026-01-29T08:22:24.517567","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"44fe0548","metadata":{"papermill":{"duration":0.006828,"end_time":"2026-01-29T08:22:24.538265","exception":false,"start_time":"2026-01-29T08:22:24.531437","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"id":"b24bd3cd","metadata":{"papermill":{"duration":0.006936,"end_time":"2026-01-29T08:22:24.552157","exception":false,"start_time":"2026-01-29T08:22:24.545221","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"nvidiaTeslaT4","dataSources":[{"datasetId":2243,"sourceId":9243,"sourceType":"datasetVersion"}],"dockerImageVersionId":31260,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.12.12"},"papermill":{"default_parameters":{},"duration":327.097193,"end_time":"2026-01-29T08:22:27.0652","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2026-01-29T08:16:59.968007","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}